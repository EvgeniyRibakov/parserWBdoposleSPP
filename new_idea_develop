Название проекта

Высокоскоростной парсер цен и аналитики товаров для e-commerce бьюти-компании (Wildberries + Ozon)

Цель проекта

Разработать максимально быстрый, устойчивый к блокировкам и точный механизм сбора цен и ключевых показателей по товарам на маркетплейсах:

Wildberries (~900 SKU)

Ozon (~700 SKU)

Обновление данных — каждые 1–2 часа, полный цикл по ~1600 SKU должен укладываться в 5–10 минут.

Роль ИИ

ИИ выступает как аналитик-архитектор и разработчик парсинга, задача которого:

спроектировать лучшую архитектурную стратегию,

подобрать оптимальные технические подходы,

определить наиболее устойчивые способы получения всех цен,
а не просто написать код «в лоб».

Ключевые ограничения и приоритеты
Абсолютные приоритеты

Скорость (главный KPI)

Минимальный риск блокировок

Фактические финальные цены (а не расчетные)

Допустимо

Неофициальные API

Перехват XHR / GraphQL

Reverse-engineering внутренних запросов

Proxy / IP-rotation / anti-detect (при необходимости)

Недопустимо

Массовый headless-парсинг как основной метод

Медленные человеко-ориентированные сценарии

Термины

СПП (Скидка Постоянного Покупателя)
Программа лояльности маркетплейса, автоматически применяющая скидку для активных покупателей.
Критично получать цену после СПП, а не только базовую цену.

Какие данные требуются
Критические (обновлять каждые 1–2 часа)

Цена со скидкой (для покупателя)

Цена после СПП (без карты)

Цена с картой лояльности

Название товара

Артикулы (внутренний + маркетплейса)

Важные

Общие остатки

Заказано шт. за период

Сумма заказов

Опциональные

Остатки по складам

Требования к точности

Допустимое отклонение: не более 1–2%

Приоритет — реальная финальная цена

Текущий статус проработки
Wildberries

Решение продумано примерно на 66%

Есть доступ к официальному API WB

Цена с картой уже успешно получается через XPath за 1–2 минуты по всем SKU

Цена после СПП пока не получена — ключевая гипотеза:
➜ перехват внутренних XHR/GraphQL запросов через Network (F12)

Ozon

Есть официальные API-ключи и ID продавца

Официальный API:

даёт базовые цены, остатки, заказы

не даёт цену с картой Ozon

Временный костыль:

скачивание отчёта из ЛК продавца

не содержит цену с картой

Рассматривается:

XPath-парсинг карточек продавца (нестабильно)

Приоритет:

найти внутренние API-запросы Ozon, которые возвращают финальные цены

Главный архитектурный вывод (результат research)
❗ Единственный масштабируемый путь

Прямые API-запросы (официальные + неофициальные XHR/GraphQL)
HTML-парсинг — только крайний fallback.

Приоритетная архитектура (итог research)
Уровень 1 — Неофициальные API (основа)

Перехват XHR / Fetch / GraphQL из seller-кабинетов

Получение структурированного JSON

Максимальная скорость

Минимальный риск блокировок (запросы выглядят легитимно)

Уровень 2 — Официальные API

Используются везде, где:

данные полные

данные точные

Основной источник:

товаров

артикулов

остатков

заказов

Уровень 3 — XPath / Headless

Только для единичных полей

Только если API-пути отсутствуют

Не основной механизм

Инструменты discovery (результат анализа идей)
Рекомендованы

mitmproxy — основной инструмент перехвата

DevTools (Network tab)

Browser extensions:

Copy as Python Requests

Requestly (modify / log requests)

Использовать только для исследования

Puppeteer / Playwright / CDP Fetch

WebdriverIO mock

Не рекомендованы как основа

Самописный браузер на C++

Массовый Selenium-парсинг

Почему не headless как основа

Медленно

Детектируется

Плохо масштабируется

Убивает KPI скорости (5–10 минут)

Антиблок стратегия (подтверждённая research)

Максимум запросов через официальные API

Внутренние API повторяются 1 в 1 с браузером:

headers

cookies

auth

Асинхронность + батчинг

При необходимости:

прокси-пул

ротация сессий

jitter задержек

Ожидаемый результат от ИИ в Cursor

ИИ должен:

Помочь найти и описать внутренние API-эндпоинты WB и Ozon

Предложить:

как безопасно реплицировать запросы

как батчить SKU

как хранить и обновлять токены

Сформировать архитектуру, которая:

обрабатывает 1600 SKU за 5–10 минут

устойчива к блокировкам

легко масштабируется

Что НЕ требуется на текущем этапе

Полный production-код

Серверная инфраструктура

Мониторинг, алерты

CI/CD

Формат вывода

Любой (предпочтительно .xlsx)

Фокус не на формате, а на скорости и корректности данных

Ключевая установка

Если данные можно получить через API — HTML парсить запрещено.
Если данные нельзя получить через API — сначала ищем internal XHR, и только потом XPath.

Сухое понятное саммари

Нужно построить сверхбыстрый парсер цен для WB и Ozon.
Основа — официальные API + перехваченные внутренние XHR/GraphQL запросы.
HTML и headless — только fallback.
Цель — 1600 SKU за 5–10 минут, с реальными финальными ценами (СПП, карты).
ИИ в Cursor используется как архитектор и помощник в поиске и репликации API-эндпоинтов.