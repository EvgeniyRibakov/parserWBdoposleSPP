# Правила разработки для проекта

## Тестирование
- Писать unit тесты для всех критичных функций
- Использовать pytest для тестирования
- Мокировать внешние API в тестах
- Целевой coverage: минимум 70%

## Git workflow
- Использовать conventional commits
- Формат: `type(scope): description`
- Типы: feat, fix, docs, style, refactor, test, chore
- Создавать feature branches для новых функций
- PR должны быть небольшими и фокусированными

## Логирование
- Использовать структурированное логирование
- Уровни: DEBUG, INFO, WARNING, ERROR, CRITICAL
- Логи должны быть информативными, но не содержать чувствительных данных

## Безопасность
- Никогда не коммитить секреты, API ключи, пароли
- Использовать .env файлы для локальной разработки
- Валидировать все пользовательские входные данные
- Использовать HTTPS для всех внешних запросов

## Производительность
- Оптимизировать запросы к API (батчинг, кэширование)
- Использовать async для I/O операций
- Профилировать код при необходимости
- Избегать избыточных запросов

## Документация
- README должен содержать инструкции по установке и использованию
- Код должен быть самодокументируемым
- Сложная логика должна иметь комментарии
- **ВАЖНО:** Не создавать лишние текстовые .md файлы без необходимости
- Перед созданием любого .md файла (кроме README) сначала обсудить в чате необходимость его создания
- Предпочтительно документировать в коде и README, а не создавать множество отдельных файлов


## Обновление документации и правил
- **КРИТИЧНО:** По мере обновления информации, вводных данных и контекста проекта ОБЯЗАТЕЛЬНО обновлять:
  - `.cursor/.cursorrules.mdc` - правила разработки
  - `README.md` - основная документация
  - Другие релевантные файлы документации
- Проект разрабатывается командой с разных устройств
- Контекст и история чата должны быть доступны всем через обновляемую документацию
- При добавлении новых функций, изменении архитектуры или правил - сразу обновлять соответствующие файлы
- Документация должна отражать актуальное состояние проекта

---
alwaysApply: true
---
не спрашивай разрешения на редактирование, всё разрешается
не проверяй и не смотри .env файл, он секретный

## Формат переформулирования корректировок пользователя

**КРИТИЧНО:** Когда пользователь присылает сообщение с корректировками или указывает на проблему, ОБЯЗАТЕЛЬНО переформулируй его в следующем формате и пришли на подтверждение ПЕРЕД исправлением кода:

**ПРОБЛЕМА:** [одно предложение]

**ГДЕ:** [файл, функция, строка кода]

**ЧТО ПРОИСХОДИТ:**
[Текущее поведение - что видите]

**ЧТО НУЖНО:**
[Ожидаемое поведение - что должно быть]

**ПРИМЕР:**
[Конкретный пример из логов/кода/таблицы]

**ПРИОРИТЕТ:** [критично / важно / можно потом]

**УЖЕ ПРОБОВАЛ:**
[Что уже делали, что не помогло]

После подтверждения пользователя - исправляй код.

**ВАЖНО:** Каждую жалобу и баг нужно уточнять по этому формату и присылать пользователю вопрос правильно ли составлен баг-репорт. После подтверждения уже исправлять.

## Работа с файлом Articles.xlsx

**КРИТИЧНО:** Файл `Articles.xlsx` является исходным файлом с данными и НИКОГДА не должен быть изменен или удален кодом.

- ✅ **РАЗРЕШЕНО:** Только читать данные из `Articles.xlsx` (ссылки и артикулы)
- ✅ **РАЗРЕШЕНО:** Обрабатывать ссылки из `Articles.xlsx` и парсить цены
- ✅ **РАЗРЕШЕНО:** Записывать результаты в Google Таблицы
- ❌ **ЗАПРЕЩЕНО:** Изменять, удалять, перезаписывать файл `Articles.xlsx`
- ❌ **ЗАПРЕЩЕНО:** Удалять строки из `Articles.xlsx`
- ❌ **ЗАПРЕЩЕНО:** Модифицировать содержимое `Articles.xlsx` любым способом

Парсер должен:
1. Читать все ссылки и артикулы из `Articles.xlsx` (лист "WBarticules" или другие возможные листы)
2. Продолжать работу с места остановки на основе количества уже обработанных товаров в Google Таблице
3. Обрабатывать все товары из файла (не останавливаться после одного товара)
4. Записывать результаты только в Google Таблицы (не в `Articles.xlsx`)
