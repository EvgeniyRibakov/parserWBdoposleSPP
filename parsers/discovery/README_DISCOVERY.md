# DISCOVERY: –ü–æ–∏—Å–∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

## üéØ –¶–µ–ª—å

–ù–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç:
- **WB:** –¶–µ–Ω—É –ø–æ—Å–ª–µ –°–ü–ü (–±–µ–∑ –∫–∞—Ä—Ç—ã –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏)
- **Ozon:** –¶–µ–Ω—É —Å –∫–∞—Ä—Ç–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ (–∑–µ–ª–µ–Ω–∞—è —Ü–µ–Ω–∞)

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ mitmproxy

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞

```bash
python parsers/discovery/mitmproxy_capture.py
```

–°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ–∫—Å–∏ –Ω–∞ –ø–æ—Ä—Ç—É 8080.

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—Ä–∞—É–∑–µ—Ä–∞

**Chrome:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ Chrome
2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–æ–∫—Å–∏: `localhost:8080`
4. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∫—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Proxy SwitchyOmega)

**–ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É:**
```bash
chrome.exe --proxy-server="http://localhost:8080"
```

### –®–∞–≥ 3: –ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –õ–ö –ø–æ–∫—É–ø–∞—Ç–µ–ª—è WB (wildberries.ru)
2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞ —Å –°–ü–ü
4. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
5. –ù–∞–∂–º–∏—Ç–µ Ctrl+C –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

### –®–∞–≥ 4: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `data/captured_requests/`

–ò—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏:
- `price` - —Ü–µ–Ω—ã
- `spp` - –°–ü–ü
- `card` / `wallet` - –∫–∞—Ä—Ç–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- `discount` - —Å–∫–∏–¥–∫–∏

## üìã –ß—Ç–æ –∏—Å–∫–∞—Ç—å

### –î–ª—è WB:
- –ó–∞–ø—Ä–æ—Å—ã –∫ `*.wildberries.ru` –∏–ª–∏ `*.wb.ru`
- GraphQL –∑–∞–ø—Ä–æ—Å—ã (–æ–±—ã—á–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç `graphql` –≤ URL)
- –ó–∞–ø—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç–æ–≤–∞—Ä–∞ (nmID, –∞—Ä—Ç–∏–∫—É–ª)
- –û—Ç–≤–µ—Ç—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å —Ü–µ–Ω–∞–º–∏:
  - `price` - –±–∞–∑–æ–≤–∞—è —Ü–µ–Ω–∞
  - `discountedPrice` - —Ü–µ–Ω–∞ —Å–æ —Å–∫–∏–¥–∫–æ–π
  - `clubDiscountedPrice` - —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –°–ü–ü + –∫–∞—Ä—Ç–∞
  - **–ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏:** —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ –°–ü–ü –ë–ï–ó –∫–∞—Ä—Ç—ã

### –î–ª—è Ozon:
- –ó–∞–ø—Ä–æ—Å—ã –∫ `*.ozon.ru`
- –ó–∞–ø—Ä–æ—Å—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç–æ–≤–∞—Ä–∞
- –û—Ç–≤–µ—Ç—ã —Å "–∑–µ–ª–µ–Ω–æ–π —Ü–µ–Ω–æ–π" (—Ü–µ–Ω–∞ —Å –∫–∞—Ä—Ç–æ–π –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏)

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: DevTools

–ï—Å–ª–∏ mitmproxy –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ DevTools:

1. –û—Ç–∫—Ä–æ–π—Ç–µ Chrome ‚Üí F12 ‚Üí Network
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É —Ç–æ–≤–∞—Ä–∞
3. –§–∏–ª—å—Ç—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ –¥–æ–º–µ–Ω—É (`wildberries.ru` –∏–ª–∏ `ozon.ru`)
4. –ò—â–∏—Ç–µ XHR/Fetch –∑–∞–ø—Ä–æ—Å—ã
5. –ö–ª–∏–∫–Ω–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π ‚Üí Copy ‚Üí Copy as cURL
6. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `docs/API_ENDPOINTS.md`:

```markdown
# –ù–∞–π–¥–µ–Ω–Ω—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

## WB: –¶–µ–Ω–∞ –ø–æ—Å–ª–µ –°–ü–ü (–±–µ–∑ –∫–∞—Ä—Ç—ã)

**URL:** `https://...`
**–ú–µ—Ç–æ–¥:** POST/GET
**Headers:**
- Authorization: ...
- Cookie: ...

**Body:**
```json
{
  "nmID": 123456789
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "price": 1000,
  "priceAfterSPP": 800  // –≠—Ç–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ!
}
```
```

